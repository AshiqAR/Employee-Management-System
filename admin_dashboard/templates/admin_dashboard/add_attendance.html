{% extends "admin_dashboard/base.html" %}
{% load static %}

{% block title %}Add Attendance{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{% static 'css/add_attendance.css' %}" />
{% endblock %}

{% block content %}
<h2>Add Attendance for {{ today }}</h2>

<form method="post">
    {% csrf_token %}
    
    <div class="date-selector">
        <label for="attendance_date">Select Date:</label>
        <input type="date" id="attendance_date" name="attendance_date" value="{{ today|date:'Y-m-d' }}" required>
    </div>

    <!-- Loop through each employee and their corresponding form -->
    {% for employee, form in employee_forms %}
        <div class="employee-attendance">
            <h3>{{ employee.first_name }} {{ employee.last_name }}</h3>
            <p>ID: {{ employee.employee_id }}</p>
            <p>Designation: {{ employee.designation }}</p>
            <p>Department: {{ employee.department.department_name }}</p>
            
            <div class="attendance-form">
                {{ form.as_p }}
            </div>
        </div>
    {% endfor %}

    <button type="submit">Save Attendance</button>
</form>

{% endblock %}

<script>
function searchEmployee() {
    const query = document.getElementById('employee_search').value.toLowerCase();
    const rows = document.querySelectorAll('.employee-attendance');

    rows.forEach(row => {
        const name = row.querySelector('h3').innerText.toLowerCase();
        row.style.display = name.includes(query) ? '' : 'none';
    });
}
</script>
